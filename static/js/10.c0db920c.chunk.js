(this["webpackJsonpTaskingManager-frontend"]=this["webpackJsonpTaskingManager-frontend"]||[]).push([[10],{650:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a.n(c),o=a(1),n=a(2),r=a(32),i=a(43),l=a(9),d=a(106),p=a(118),m=a(79),j=a(11),E=a(40),u=a(5),k=a(231),O=a(145),b=a(233);t.default=e=>{const t=Object(o.d)(e=>e.auth.get("token")),a=Object(o.d)(e=>e.preferences.locale),[h,g]=Object(c.useState)(e.defaultUserEditor),[T,f]=Object(c.useState)([]),[w,v]=Object(c.useState)(null),A=Object(o.c)(),S=Object(m.b)(),I=(t,c,s)=>{const o=Object(p.c)(h,e.project,e.tasks,e.selectedTasks,[window.innerWidth,window.innerHeight],s,a);y(e.selectedTasks,e.project.projectId,t),Object(n.e)("/projects/".concat(e.project.projectId,"/").concat(c,"/").concat(o))},N=(e,t)=>{["JOSM","ID"].includes(h)||e.close(),S(),v(t)},y=(e,t,a)=>{A({type:"SET_LOCKED_TASKS",tasks:e}),A({type:"SET_PROJECT",project:t}),A({type:"SET_TASKS_STATUS",status:a})},C=async()=>{if(["selectAnotherProject","mappingIsComplete","projectIsComplete"].includes(e.taskAction)&&Object(n.e)("/explore/"),"JOSM"===h&&!window.safari)try{await fetch(Object(p.a)("version",{jsonp:"checkJOSM"}))}catch(s){return void v("JOSM")}let c;if(["JOSM","ID"].includes(h)||(c=window.open("","TM-".concat(e.project.projectId,"-").concat(e.selectedTasks))),["validateSelectedTask","validateAnotherTask","validateATask"].includes(e.taskAction)&&Object(j.c)("projects/".concat(e.project.projectId,"/tasks/actions/lock-for-validation/"),JSON.stringify({taskIds:e.selectedTasks}),t).then(e=>{I("LOCKED_FOR_VALIDATION","validate",c)}).catch(e=>N(c,e.message)),["mapSelectedTask","mapAnotherTask","mapATask"].includes(e.taskAction)&&Object(j.b)("projects/".concat(e.project.projectId,"/tasks/actions/lock-for-mapping/").concat(e.selectedTasks[0],"/"),t,"POST").then(e=>{I("LOCKED_FOR_MAPPING","map",c)}).catch(e=>N(c,e.message)),["resumeMapping","resumeValidation"].includes(e.taskAction)){const t=Object(p.c)(h,e.project,e.tasks,e.selectedTasks,[window.innerWidth,window.innerHeight],c,a),s="resumeMapping"===e.taskAction?"map":"validate";Object(n.e)("/projects/".concat(e.project.projectId,"/").concat(s,"/").concat(t))}};Object(c.useEffect)(()=>{if(e.taskAction&&e.project.mappingEditors&&(e.taskAction.startsWith("validate")||"resumeValidation"===e.taskAction)){const t=Object(d.a)(e.project.validationEditors,e.project.customEditor);f(t),e.project.validationEditors.includes(e.defaultUserEditor)?g(e.defaultUserEditor):M(t)}else{const t=Object(d.a)(e.project.mappingEditors,e.project.customEditor);f(t),e.project.mappingEditors.includes(e.defaultUserEditor)?g(e.defaultUserEditor):M(t)}},[e.taskAction,e.project.mappingEditors,e.project.validationEditors,e.project.customEditor,e.defaultUserEditor]);const M=e=>g(e[0].value),J="db ttu f6 blue-light mb2";return s.a.createElement("div",{className:"cf bg-white pb2 ph4-l ph2"},null!==w&&s.a.createElement(r.a,{modal:!0,open:!0,closeOnEscape:!0,closeOnDocumentClick:!0,onClose:()=>v(null)},t=>s.a.createElement(b.b,{project:e.project,error:w,close:t,lockTasks:C})),s.a.createElement("div",{className:"w-25-ns w-40 fl"},s.a.createElement("h3",{className:J},s.a.createElement(i.a,l.a.typesOfMapping)),s.a.createElement("div",{className:"db fl pt1"},s.a.createElement(O.a,{types:e.project.mappingTypes}))),s.a.createElement("div",{className:"w-25-ns w-60 fl"},s.a.createElement("h3",{className:J},s.a.createElement(i.a,l.a.imagery)),s.a.createElement(k.a,{value:e.project.imagery})),s.a.createElement("div",{className:"w-20-ns w-40 fl"},s.a.createElement("h3",{className:J},s.a.createElement(i.a,l.a.editor)),s.a.createElement(E.a,{options:T,value:h,display:s.a.createElement(i.a,l.a.selectEditor),className:"bg-white bn",toTop:!0,onChange:M,onAdd:()=>{},onRemove:()=>{}})),s.a.createElement("div",{className:"w-30-ns w-60 fl tr"},s.a.createElement("div",{className:"mt3"},s.a.createElement(u.a,{className:"white bg-red",onClick:()=>C()},["selectAnotherProject","mappingIsComplete","projectIsComplete"].includes(e.taskAction)?s.a.createElement(i.a,l.a.selectAnotherProject):s.a.createElement(i.a,Object.assign({},l.a[e.taskAction],{values:{number:e.selectedTasks?e.selectedTasks.length:0}}))))))}}}]);
//# sourceMappingURL=10.c0db920c.chunk.js.map