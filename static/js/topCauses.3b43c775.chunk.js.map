{"version":3,"sources":["utils/formatChartJSData.js","components/userDetail/topCauses.js"],"names":["formatChartData","reference","stats","data","datasets","backgroundColor","labels","map","f","field","total","reduce","a","b","v","Math","round","borderColor","label","formatTimelineData","mappedTasksConfig","validatedTasksConfig","mapped","color","fill","validated","entry","date","cumulative_mapped","total_tasks","cumulative_validated","formatTasksStatsData","formatTooltip","context","dataset","dataIndex","concat","formatTimelineTooltip","isPercent","ChartJS","register","ArcElement","Tooltip","Legend","TopCauses","_ref","userStats","intl","useIntl","colours","CHART_COLOURS","green","orange","red","blue","interests","ContributionsByInterest","slice","c","i","name","countProjects","white","Others","push","formatMessage","messages","others","length","_jsx","className","children","_jsxs","FormattedMessage","topCausesTitle","projectsMapped","some","x","isNaN","Doughnut","options","aspectRatio","plugins","legend","position","boxWidth","tooltip","callbacks","noProjectsData"],"mappings":"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","file":"static/js/topCauses.3b43c775.chunk.js","sourcesContent":["export const formatChartData = (reference, stats) => {\n  let data = { datasets: [{ data: [], backgroundColor: [] }], labels: [] };\n\n  data.datasets[0].data = reference.map((f) => stats[f.field]);\n  const total = data.datasets[0].data.reduce((a, b) => a + b, 0);\n  data.datasets[0].data = data.datasets[0].data.map((v) => Math.round((v / total) * 100));\n  data.datasets[0].backgroundColor = reference.map((f) => f.backgroundColor);\n  data.datasets[0].borderColor = reference.map((f) => f.borderColor);\n  data.labels = reference.map((f) => f.label);\n\n  return data;\n};\n\nexport const formatTimelineData = (stats, mappedTasksConfig, validatedTasksConfig) => {\n  let mapped = {\n    data: [],\n    backgroundColor: mappedTasksConfig.color,\n    borderColor: mappedTasksConfig.color,\n    fill: false,\n    label: mappedTasksConfig.label,\n  };\n  let validated = {\n    data: [],\n    backgroundColor: validatedTasksConfig.color,\n    borderColor: validatedTasksConfig.color,\n    fill: false,\n    label: validatedTasksConfig.label,\n  };\n\n  const labels = stats.map((entry) => entry.date);\n  mapped.data = stats.map((entry) =>\n    Math.round((entry.cumulative_mapped / entry.total_tasks) * 100),\n  );\n  validated.data = stats.map((entry) =>\n    Math.round((entry.cumulative_validated / entry.total_tasks) * 100),\n  );\n\n  return { datasets: [validated, mapped], labels: labels };\n};\n\nexport const formatTasksStatsData = (stats, mappedTasksConfig, validatedTasksConfig) => {\n  let mapped = {\n    data: [],\n    backgroundColor: mappedTasksConfig.color,\n    label: mappedTasksConfig.label,\n  };\n  let validated = {\n    data: [],\n    backgroundColor: validatedTasksConfig.color,\n    label: validatedTasksConfig.label,\n  };\n\n  const labels = stats.map((entry) => entry.date);\n  mapped.data = stats.map((entry) => entry.mapped);\n  validated.data = stats.map((entry) => entry.validated);\n\n  return { datasets: [mapped, validated], labels: labels };\n};\n\nexport const formatTooltip = (context) => {\n  var label = context.label;\n  if (label) label += ': ';\n  label += context.dataset.data[context.dataIndex];\n\n  return `${label}%`;\n};\n\nexport const formatTimelineTooltip = (context, isPercent) => {\n  var label = context.dataset.label || '';\n  if (label) label += ': ';\n  label += context.dataset.data[context.dataIndex];\n\n  return `${label}${isPercent ? '%' : ''}`;\n};\n","import React from 'react';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\nimport { Doughnut } from 'react-chartjs-2';\nimport { FormattedMessage, useIntl } from 'react-intl';\n\nimport messages from './messages';\nimport { CHART_COLOURS } from '../../config';\nimport { formatChartData, formatTooltip } from '../../utils/formatChartJSData';\n\nChartJS.register(ArcElement, Tooltip, Legend);\n\nconst TopCauses = ({ userStats }) => {\n  const intl = useIntl();\n  const sliceVal = 3;\n  const colours = [\n    CHART_COLOURS.green,\n    CHART_COLOURS.orange,\n    CHART_COLOURS.red,\n    CHART_COLOURS.blue,\n  ];\n  const stats = {};\n\n  let interests = userStats.ContributionsByInterest.slice(0, sliceVal).map((c, i) => {\n    stats[c.name] = c.countProjects;\n    return {\n      label: c.name,\n      field: c.name,\n      backgroundColor: colours[i],\n      borderColor: CHART_COLOURS.white,\n    };\n  });\n  stats.Others = userStats.ContributionsByInterest.slice(sliceVal)\n    .map((c) => c.countProjects)\n    .reduce((a, b) => a + b, 0);\n\n  interests.push({\n    label: intl.formatMessage(messages.others),\n    field: 'Others',\n    backgroundColor: colours[colours.length - 1],\n    borderColor: CHART_COLOURS.white,\n  });\n  const data = formatChartData(interests, stats);\n\n  return (\n    <div className=\"pv2 ph3 bg-white blue-dark shadow-6 h-100\">\n      <div className=\"ml2 mt1 mb3\">\n        <h3 className=\"f125 mv3 fw6\">\n          <FormattedMessage {...messages.topCausesTitle} />\n        </h3>\n        {userStats.projectsMapped && data.datasets[0].data.some((x) => !isNaN(x)) ? (\n          <Doughnut\n            data={data}\n            options={{\n              aspectRatio: 2,\n              plugins: {\n                legend: { position: 'right', labels: { boxWidth: 12 } },\n                tooltip: { callbacks: { label: (context) => formatTooltip(context) } },\n              },\n            }}\n          />\n        ) : (\n          <div className=\"h-100 tc pv5 blue-grey\">\n            <FormattedMessage {...messages.noProjectsData} />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default TopCauses;\n"],"sourceRoot":""}