(this["webpackJsonpTaskingManager-frontend"]=this["webpackJsonpTaskingManager-frontend"]||[]).push([[1629],{2341:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u}));var a=n(1),r=n(10),c=n(50),s=n(2039),o=n(2258),i=(n(2259),n(9)),d=n(55),l=n(0);function u(e){let{setDisable:t,comment:n,presets:u,imagery:g,gpxUrl:b}=e;const f=Object(r.c)(),h=Object(c.a)(),m=Object(r.d)((e=>e.auth.session)),p=Object(r.d)((e=>e.editor.context)),w=Object(r.d)((e=>e.preferences.locale)),[j,O]=Object(a.useState)(!1),k="undefined"!==typeof window,x=p&&p.background()&&p.background().findSource("custom");return Object(a.useEffect)((()=>{if(!j&&g&&x)if(g.startsWith("http"))p.background().baseLayerSource(x.template(g)),O(!0),window.iD.prefs("background-custom-template",g);else{const e=p.background().findSource(g);e&&p.background().baseLayerSource(e)}}),[j,g,p,x]),Object(a.useEffect)((()=>{k&&null===p&&f({type:"SET_EDITOR",context:window.iD.coreContext()})}),[k,p,f]),Object(a.useEffect)((()=>{p&&n&&p.defaultChangesetComment(n)}),[n,p]),Object(a.useEffect)((()=>{if(m&&w&&o&&p){try{u.length?window.iD.presetManager.addablePresetIDs(u):window.iD.presetManager.addablePresetIDs(null)}catch(n){window.iD.presetManager.addablePresetIDs(null)}p.embed(!0).assetPath("/static/id/").locale(w).setsDocumentTitle(!1).containerNode(document.getElementById("id-container")),void 0!==p.ui()?(p.reset(),p.ui().restart()):p.init(),b&&fetch(b).then((e=>e.text())).then((e=>{let t=(new DOMParser).parseFromString(e,"text/xml"),n=t.getElementsByTagName("trk")[0].childNodes[0],a=n.textContent.match(/\d+/g);n.textContent=h.formatMessage(d.a.gpxNameAttribute,{projectId:a[0]}),p.layers().layer("data").geojson(Object(s.gpx)(t))})).catch((e=>{console.error("Error loading GPX data")}));let a=p.connection();var e={url:i.M,client_id:i.I,client_secret:i.J,redirect_uri:i.K,access_token:m.osm_oauth_token};a.switch(e);const r=e=>e.modified.length||e.created.length||e.deleted.length;p.history().on("change",(()=>{r(p.history().changes())?t(!0):t(!1)}))}}),[m,p,t,u,w,b,h]),Object(l.jsx)("div",{className:"w-100 vh-minus-69-ns",id:"id-container"})}}}]);
//# sourceMappingURL=1629.7bff65f3.chunk.js.map