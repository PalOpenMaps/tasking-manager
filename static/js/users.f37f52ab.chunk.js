(this["webpackJsonpTaskingManager-frontend"]=this["webpackJsonpTaskingManager-frontend"]||[]).push([[827],{2361:function(e,t,s){"use strict";s.r(t),s.d(t,"UsersList",(function(){return F}));var a=s(1),l=s(30),c=s(62),r=s(10),n=s(92),i=s.n(n),j=s(165),o=s.n(j),b=s(82),m=s(42),u=s(106),d=s(29),p=s(171),h=s(13),O=s(121),x=s(118),v=s(0);const g=e=>[...Array(e).keys()].map(((e,t)=>Object(v.jsxs)("div",{className:"bg-white cf flex items-center pa3 ba mb1 b--grey-light blue-dark shadow-hover",children:[Object(v.jsxs)("div",{className:"w-50-ns w-100 fl flex items-center",children:[Object(v.jsx)(x.RoundShape,{className:"show-loading-animation dib mt1",style:{width:32,height:32},color:"#DDD"}),Object(v.jsx)(x.TextRow,{className:"show-loading-animation blue-grey mr2 ml3 dib",color:"#CCC",style:{width:"45%",marginTop:0}})]}),Object(v.jsx)("div",{className:"w-20 fl dib-ns dn tc",children:Object(v.jsx)(x.TextRow,{className:"show-loading-animation blue-grey mr2 ml3",color:"#CCC",style:{width:"45%",marginTop:0}})}),Object(v.jsx)("div",{className:"w-20 fl dib-ns dn tc",children:Object(v.jsx)(x.TextRow,{className:"show-loading-animation blue-grey mr2 ml3",color:"#CCC",style:{width:"45%",marginTop:0}})})]},t))),N=e=>{let{filters:t,setFilters:s,updateFilters:c,intl:r}=e;const n=Object(a.useRef)(null);return Object(v.jsx)("div",{children:Object(v.jsx)(l.a,{...m.a.enterUsername,children:e=>Object(v.jsxs)("form",{className:"relative",onSubmit:e=>{e.preventDefault()},children:[Object(v.jsx)("div",{children:Object(v.jsx)(h.fb,{onClick:()=>n.current.focus(),className:"absolute grey-light pl2 pt2"})}),Object(v.jsx)("input",{id:"name",ref:n,autoComplete:"off",value:""!==t.username?t.username:"",onChange:e=>c("username",e.target.value),placeholder:e,className:"input-reset ba b--grey-light pa1 lh-copy db w-100",style:{textIndent:"30px"},type:"text","aria-describedby":"name-desc"}),Object(v.jsx)(h.n,{onClick:()=>{s((e=>({...e,username:""})))},className:"absolute w1 h1 top-0 pt2 pointer pr2 right-0 red ".concat(t.username?"":"dn")})]})})})},f=e=>{let{filters:t,setFilters:s,updateFilters:a}=e;const c=["ALL","MAPPER","ADMIN","READ_ONLY"].map((e=>({value:e,label:Object(v.jsx)(l.a,{...m.a["userRole".concat(e)]})})));return Object(v.jsx)("div",{children:Object(v.jsx)(O.a,{onChange:e=>{const t=e&&e[0]&&e[0].value;a("role",t)},options:c,value:t.role,className:"ba b--grey-light bg-white mr1 f6 v-mid pv2 fl mt1 br1 f5 pointer"})})},w=e=>{let{filters:t,setFilters:s,updateFilters:a}=e;const c=["ALL","BEGINNER","INTERMEDIATE","ADVANCED"].map((e=>({value:e,label:Object(v.jsx)(l.a,{...m.a["mapperLevel".concat(e)]})})));return Object(v.jsx)("div",{children:Object(v.jsx)(O.a,{onChange:e=>{const t=e&&e[0]&&e[0].value;a("level",t)},options:c,value:t.level,className:"ba b--grey-light bg-white mr1 f6 v-mid pv2 fl mt1 br1 f5 pointer"})})},y=e=>{let{filters:t,setFilters:s,initialFilters:a}=e;const c=(e,t)=>{s((s=>({...s,[e]:t})))};return Object(v.jsxs)("div",{className:"w-100 mb3 flex items-center",children:[Object(v.jsx)("div",{className:"fl w-20 mr3",children:Object(v.jsx)(N,{filters:t,setFilters:s,updateFilters:c})}),Object(v.jsx)("div",{className:"mr3 tr",children:Object(v.jsx)(w,{filters:t,setFilters:s,updateFilters:c})}),Object(v.jsx)("div",{className:"tr mr3",children:Object(v.jsx)(f,{filters:t,setFilters:s,updateFilters:c})}),(t.username||"ALL"!==t.level||"ALL"!==t.role)&&Object(v.jsx)("div",{className:"tr red pointer",onClick:e=>{s(a)},children:Object(v.jsx)(l.a,{...m.a.clearFilters})})]})},L=e=>{let{filters:t,setFilters:s}=e;const c=Object(r.d)((e=>e.auth.token)),[n,j]=Object(a.useState)(null),o=Object(r.d)((e=>e.auth.userDetails)),[b,u]=Object(a.useState)({status:null,message:""}),[h,O]=Object(a.useState)(!0),[x,N]=Object(a.useState)(null);return Object(a.useEffect)((()=>{(async e=>{O(!0);const t="users/?".concat(e);Object(d.b)(t,c).then((e=>{j(e),O(!1)})).catch((e=>N(e)))})(Object.entries(t).map((e=>{let[t,s]=e;return"role"===t||"level"===t?"ALL"!==s?"".concat(t,"=").concat(s):null:""!==s?"".concat(t,"=").concat(s):null})).filter((e=>null!==e)).join("&"))}),[t,c,b]),Object(v.jsxs)("div",{className:"w-100",children:[(null===n||void 0===n?void 0:n.users)&&Object(v.jsx)("p",{className:"f6 mt0",children:Object(v.jsx)(l.a,{...m.a.totalUsers,values:{total:n.pagination.total}})}),Object(v.jsxs)("div",{className:"w-100 f5",children:[Object(v.jsx)(i.a,{showLoadingAnimation:!0,customPlaceholder:g(4),delay:10,ready:!h&&!x,children:Object(v.jsx)("ul",{className:"list pa0 ma0",children:null===n||void 0===n?void 0:n.users.map((e=>Object(v.jsx)(C,{user:e,token:c,username:o.username,setStatus:u},e.id)))})}),null===n||0===n.pagination.total?null:Object(v.jsx)(p.a,{activePage:t.page,setPageFn:e=>s((t=>({...t,page:e}))),lastPage:n.pagination.pages,className:"pv3 tr"})]})]})},A=e=>{let{user:t,token:s,close:a,setStatus:c}=e;const r="h1 w1 red",n=(e,r)=>{const n={role:"users/".concat(t.username,"/actions/set-role/").concat(r,"/"),mapperLevel:"users/".concat(t.username,"/actions/set-level/").concat(r,"/")};Object(d.b)(n[e],s,"PATCH").then((()=>{a(),c({success:!0}),o.a.success(Object(v.jsx)(l.a,{...m.a.userAttributeUpdationSuccess,values:{attribute:e}}))})).catch((()=>o.a.error(Object(v.jsx)(l.a,{...m.a.userAttributeUpdationFailure,values:{attribute:e}}))))};return Object(v.jsxs)("div",{className:"w-100 f6 tl ph1",children:[Object(v.jsxs)("div",{className:"w-100 bb b--tan",children:[Object(v.jsx)("p",{className:"b mv3",children:Object(v.jsx)(l.a,{...m.a.setRole})}),["MAPPER","ADMIN","READ_ONLY"].map((e=>Object(v.jsxs)("div",{role:"button",onClick:()=>n("role",e),className:"mv1 pv1 dim pointer w-100 flex items-center justify-between",children:[Object(v.jsx)("p",{className:"ma0",children:Object(v.jsx)(l.a,{...m.a["userRole".concat(e)]})}),e===t.role?Object(v.jsx)(h.g,{className:r}):null]},e)))]}),Object(v.jsxs)("div",{className:"w-100",children:[Object(v.jsx)("p",{className:"b mv3",children:Object(v.jsx)(l.a,{...m.a.setLevel})}),["BEGINNER","INTERMEDIATE","ADVANCED"].map((e=>Object(v.jsxs)("div",{role:"button",onClick:()=>n("mapperLevel",e),className:"mv1 pv1 dim pointer w-100 flex items-center justify-between",children:[Object(v.jsx)("p",{className:"ma0",children:Object(v.jsx)(l.a,{...m.a["mapperLevel".concat(e)]})}),e===t.mappingLevel?Object(v.jsx)(h.g,{className:r}):null]},e)))]})]})};function C(e){let{user:t,token:s,username:c,setStatus:r}=e;const[n,i]=Object(a.useState)(!1);return Object(v.jsxs)("li",{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),className:"bg-white cf flex items-center pa3 ba mb1 b--grey-light blue-dark ".concat(n?"shadow-4":""),children:[Object(v.jsxs)("div",{className:"w-50-ns w-100 fl",children:[Object(v.jsx)(u.b,{picture:t.pictureUrl,username:t.username,colorClasses:"white bg-blue-grey"}),Object(v.jsx)("a",{className:"blue-grey mr2 ml3 link",rel:"noopener noreferrer",target:"_blank",href:"/users/".concat(t.username),children:t.username})]}),Object(v.jsx)("div",{className:"w-20 fl dib-ns dn tc",children:Object(v.jsx)(l.a,{...m.a["mapperLevel".concat(t.mappingLevel)]})}),Object(v.jsx)("div",{className:"w-20 fl dib-ns dn tc",children:Object(v.jsx)(l.a,{...m.a["userRole".concat(t.role)]})}),c===t.username?null:Object(v.jsx)("div",{className:"w-10 fl tr",children:Object(v.jsx)(b.a,{trigger:Object(v.jsx)("span",{children:Object(v.jsx)(h.ib,{width:"18px",height:"18px",className:"pointer hover-blue-grey"})}),position:"right center",closeOnDocumentClick:!0,className:"user-popup",children:e=>Object(v.jsx)(A,{user:t,token:s,close:e,setStatus:r})})})]},t.username)}var k=s(164);const F=()=>{Object(k.b)("Manage users");const e={level:"ALL",role:"ALL",username:"",page:1},[t,s]=Object(a.useState)(e);return Object(v.jsxs)("div",{className:"pv4 blue-dark",children:[Object(v.jsx)("h3",{className:"barlow-condensed f2 ma0 v-mid dib ttu",children:Object(v.jsx)(l.a,{...c.a.manageUsers})}),Object(v.jsx)(y,{filters:t,setFilters:s,initialFilters:e}),Object(v.jsx)("div",{className:"w-50-l w-70-m w-100 mb4",children:Object(v.jsx)(L,{filters:t,setFilters:s})})]})}}}]);
//# sourceMappingURL=users.f37f52ab.chunk.js.map