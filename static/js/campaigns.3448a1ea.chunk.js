(this["webpackJsonpTaskingManager-frontend"]=this["webpackJsonpTaskingManager-frontend"]||[]).push([[797],{1964:function(e,a,t){"use strict";t.d(a,"a",(function(){return s}));var c=t(1);const s=function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[t,s]=Object(c.useState)("idle"),[n,i]=Object(c.useState)(null),[l,r]=Object(c.useState)(null),b=Object(c.useCallback)((function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return s("pending"),i(null),r(null),e(a).then((e=>{i(e),s("success")})).catch((e=>{r(e),s("error")}))}),[e]);return Object(c.useEffect)((()=>{a&&b()}),[b,a]),{execute:b,status:t,value:n,error:l}}},2366:function(e,a,t){"use strict";t.r(a),t.d(a,"CampaignError",(function(){return F})),t.d(a,"ListCampaigns",(function(){return L})),t.d(a,"CreateCampaign",(function(){return T})),t.d(a,"EditCampaign",(function(){return J}));var c=t(1),s=t(10),n=t(6),i=t(23),l=t(30),r=t(57),b=t(165),d=t.n(b),j=t(62),m=t(120),o=t(29),u=t(92),h=t.n(u),g=t(2162),O=t(70),p=t(119),x=t(32),f=t(13),w=t(80),v=t(0);function N(e){let{campaigns:a,userDetails:t,isCampaignsFetched:s}=e;const[n,i]=Object(c.useState)(""),r=null===a||void 0===a?void 0:a.filter((e=>e.name.toLowerCase().includes(n.toLowerCase())));return Object(v.jsx)(p.d,{title:Object(v.jsx)(l.a,{...O.a.manage,values:{entity:Object(v.jsx)(l.a,{...O.a.campaigns})}}),showAddButton:"ADMIN"===t.role,managementView:!0,children:Object(v.jsxs)(h.a,{showLoadingAnimation:!0,customPlaceholder:Object(g.a)(4),delay:10,ready:s,children:[Object(v.jsx)("div",{className:"w-20-l w-25-m",children:Object(v.jsx)(w.i,{value:n,placeholderMsg:O.a.searchCampaigns,onChange:e=>i(e.target.value),onCloseIconClick:()=>i("")})}),null!==r&&void 0!==r&&r.length?r.map(((e,a)=>Object(v.jsx)(C,{campaign:e},a))):Object(v.jsx)("div",{children:Object(v.jsx)(l.a,{...O.a.noCampaigns})})]})})}function C(e){let{campaign:a}=e;return Object(v.jsx)(i.a,{to:"".concat(a.id,"/"),className:"w-50-ns w-100 fl pr3",children:Object(v.jsxs)("div",{className:"cf bg-white blue-dark br1 mv2 pv4 ph3 ba br1 b--grey-light shadow-hover",children:[Object(v.jsx)("div",{className:"dib v-mid pr3",children:Object(v.jsx)("div",{className:"z-1 fl br-100 tc h2 w2 bg-blue-light white",children:Object(v.jsx)("span",{className:"relative w-50 dib",children:Object(v.jsx)(f.F,{style:{paddingTop:"0.4175rem"}})})})}),Object(v.jsx)("h3",{className:"f3 mv0 dib v-mid",children:a.name})]})})}function y(e){return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:"cf",children:[Object(v.jsx)("label",{className:"db pt3 pb2",children:Object(v.jsx)(l.a,{...O.a.name})}),Object(v.jsx)(r.a,{name:"name",component:"input",type:"text",className:"blue-grey w-100 pv3 ph2 input-reset ba b--grey-light bg-transparent",required:!0})]})})}function S(e){let{userDetails:a,campaign:t,updateCampaignAsync:c,disabled:s,disableErrorAlert:n}=e;return Object(v.jsx)(r.b,{onSubmit:e=>c.execute(e),initialValues:t,render:e=>{let{handleSubmit:a,dirty:t,submitSucceeded:i,dirtySinceLastSubmit:r,form:b,submitting:d,values:j}=e;const m=i?r&&t:t;return r&&n(),Object(v.jsxs)("div",{className:"blue-grey mb3",children:[Object(v.jsxs)("div",{className:"bg-white b--grey-light pa4 ".concat(m?"bt bl br":"ba"),children:[Object(v.jsx)("h3",{className:"f3 fw6 dib blue-dark mv0",children:Object(v.jsx)(l.a,{...O.a.campaignInfo})}),Object(v.jsx)("form",{id:"campaign-form",onSubmit:a,children:Object(v.jsx)("fieldset",{className:"bn pa0",disabled:d||s,children:Object(v.jsx)(y,{})})})]}),m&&Object(v.jsxs)("div",{className:"cf pt0 h3",children:[Object(v.jsx)("div",{className:"w-70-l w-50 fl tr dib bg-grey-light",children:Object(v.jsx)(x.b,{className:"blue-dark bg-grey-light h3",onClick:()=>b.restart(),children:Object(v.jsx)(l.a,{...O.a.cancel})})}),Object(v.jsx)("div",{className:"w-30-l w-50 h-100 fr dib",children:Object(v.jsx)(x.b,{onClick:()=>a(),className:"w-100 h-100 bg-red white",disabledClassName:"bg-red o-50 white w-100 h-100",loading:"pending"===c.status,disabled:"pending"===c.status,children:Object(v.jsx)(l.a,{...O.a.save})})})]})]})}})}var k=t(1962),E=t(1944),A=t(164),D=t(1914),I=t(1964),M=t(1993);const F=e=>{let{error:a}=e;return Object(v.jsx)(v.Fragment,{children:a&&Object(v.jsx)("div",{className:"cf pv2",children:Object(v.jsx)(D.a,{type:"error",children:Object(v.jsx)(l.a,{...j.a.campaignError})})})})};function L(){Object(A.b)("Manage campaigns");const e=Object(s.d)((e=>e.auth.userDetails)),[a,t,c]=Object(m.a)("campaigns/"),n=!t&&!a;return Object(v.jsx)(N,{campaigns:c.campaigns,userDetails:e,isCampaignsFetched:n})}function T(){Object(A.b)("Create new campaign");const e=Object(n.q)(),a=Object(s.d)((e=>e.auth.token)),[t,b]=Object(c.useState)(!1),m=Object(I.a)((t=>(b(!1),Object(o.d)("campaigns/",JSON.stringify(t),a,"POST").then((a=>{d.a.success(Object(v.jsx)(l.a,{...j.a.entityCreationSuccess,values:{entity:"campaign"}})),e("/manage/campaigns/".concat(a.campaignId))})).catch((()=>b(!0))))));return Object(v.jsx)(r.b,{onSubmit:e=>m.execute(e),render:e=>{let{handleSubmit:a,pristine:c,form:s,submitting:n,values:r}=e;return Object(v.jsxs)("form",{onSubmit:a,className:"blue-grey",children:[Object(v.jsxs)("div",{className:"cf vh-100",children:[Object(v.jsx)("h3",{className:"f2 mb3 ttu blue-dark fw7 barlow-condensed",children:Object(v.jsx)(l.a,{...j.a.newCampaign})}),Object(v.jsxs)("div",{className:"w-40-l w-100 fl",children:[Object(v.jsxs)("div",{className:"bg-white b--grey-light ba pa4 mb3",children:[Object(v.jsx)("h3",{className:"f3 blue-dark mv0 fw6",children:Object(v.jsx)(l.a,{...j.a.campaignInfo})}),Object(v.jsx)(y,{})]}),t&&Object(v.jsx)(D.b,{entity:"campaign"})]})]}),Object(v.jsxs)("div",{className:"fixed left-0 bottom-0 cf bg-white h3 w-100",children:[Object(v.jsx)("div",{className:"w-80-ns w-60-m w-50 h-100 fl tr",children:Object(v.jsx)(i.a,{to:"../",children:Object(v.jsx)(x.c,{className:"bg-white mr5 pr2 h-100 bn bg-white blue-dark",children:Object(v.jsx)(l.a,{...j.a.cancel})})})}),Object(v.jsx)("div",{className:"w-20-l w-40-m w-50 h-100 fr",children:Object(v.jsx)(x.e,{disabled:n||c||"pending"===m.status,loading:n||"pending"===m.status,className:"w-100 h-100 bg-red white",disabledClassName:"bg-red o-50 white w-100 h-100",children:Object(v.jsx)(l.a,{...j.a.createCampaign})})})]})]})}})}function J(){const{id:e}=Object(n.s)(),a=Object(s.d)((e=>e.auth.userDetails)),t=Object(s.d)((e=>e.auth.token)),[i,r,b]=Object(m.a)("campaigns/".concat(e,"/"),e);Object(A.b)("Edit ".concat(b.name));const[d,o,u]=Object(m.a)("projects/?campaign=".concat(encodeURIComponent(b.name),"&omitMapResults=true"),void 0!==b.name),[h,g]=Object(c.useState)(!1),O=Object(I.a)((a=>Object(M.a)("campaigns/".concat(e,"/"),"campaign",a,t,(()=>g(!1)),(()=>g(!0)))));return Object(v.jsxs)("div",{className:"cf pv4 bg-tan",children:[Object(v.jsxs)("div",{className:"cf",children:[Object(v.jsx)("h3",{className:"f2 ttu blue-dark fw7 barlow-condensed v-mid ma0 dib ttu",children:Object(v.jsx)(l.a,{...j.a.manageCampaign})}),Object(v.jsx)(E.a,{id:b.id,name:b.name,type:"campaigns"})]}),Object(v.jsxs)("div",{className:"w-40-l w-100 mt4 fl",children:[Object(v.jsx)(S,{userDetails:a,campaign:{name:b.name},updateCampaignAsync:O,disabled:i||r,disableErrorAlert:()=>h&&g(!1)}),Object(v.jsx)(F,{error:h})]}),Object(v.jsx)("div",{className:"w-60-l w-100 mt4 pl5-l pl0 fl",children:Object(v.jsx)(k.a,{projects:!o&&!d&&u,viewAllEndpoint:"/manage/projects/?campaign=".concat(encodeURIComponent(b.name)),ownerEntity:"campaign"})})]})}}}]);
//# sourceMappingURL=campaigns.3448a1ea.chunk.js.map