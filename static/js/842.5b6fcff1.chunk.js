(this["webpackJsonpTaskingManager-frontend"]=this["webpackJsonpTaskingManager-frontend"]||[]).push([[842],{2260:function(e){e.exports=JSON.parse('{"a":"@rapideditor/rapid","b":"2.2.5"}')},2342:function(e,t,n){"use strict";n.r(t),n.d(t,"RapidEditor",(function(){return h})),n.d(t,"generateStartingHash",(function(){return f})),n.d(t,"equalsUrlParameters",(function(){return u})),n.d(t,"updateUrl",(function(){return l}));var s=n(1),o=n(10),i=n(9),r=n(146),c=n(2260),a=n(0);const d="https://cdn.jsdelivr.net/npm/".concat(c.a,"@~").concat(c.b,"/dist/");function u(e,t){if(e.size===t.size){for(const[n,s]of e)if(!t.has(n)||t.get(n)!==s)return!1;return!0}return!1}function l(e){const t=window.location.href,n=window.location.pathname+window.location.search+"#"+e.toString();window.history.pushState(null,"",n),window.dispatchEvent(new HashChangeEvent("hashchange",{newUrl:n,oldUrl:t}))}function f(e){let{comment:t,presets:n,gpxUrl:s,powerUser:o,imagery:i}=e;const r=new URLSearchParams(window.location.hash.substring(1));return t&&r.set("comment",t),s&&r.set("data",s),void 0!==o&&r.set("poweruser",o.toString()),n&&r.set("presets",n.join(",")),i&&(i.startsWith("http")?r.set("background","custom:"+i):r.set("background",i)),!u(r,new URLSearchParams(window.location.hash.substring(1)))&&r}function p(e){var t;const n=null===e||void 0===e||null===(t=e.systems)||void 0===t?void 0:t.ui;null!==n&&void 0!==n&&n.started&&n.resize()}function h(e){let{setDisable:t,comment:n,presets:c,imagery:u,gpxUrl:h,powerUser:m=!1,showSidebar:w=!0}=e;const b=Object(o.c)(),v=Object(o.d)((e=>e.auth.session)),[g,y]=Object(s.useState)(void 0!==window.Rapid),{context:E,dom:j}=Object(o.d)((e=>e.editor.rapidContext)),O=Object(o.d)((e=>e.preferences.locale)),_="undefined"!==typeof window;return Object(s.useEffect)((()=>{if(g||E)E&&!g&&y(!0);else{const e=document.createElement("link");e.setAttribute("type","text/css"),e.setAttribute("rel","stylesheet"),e.setAttribute("href",d+"rapid.css"),document.head.appendChild(e);const t=document.createElement("script");t.src=d+"rapid.js",t.async=!0,t.onload=()=>y(!0),document.body.appendChild(t)}}),[g,y,E]),Object(s.useEffect)((()=>()=>{b({type:"SET_VISIBILITY",isVisible:!0})})),Object(s.useEffect)((()=>{if(_&&null===E&&g){const e=document.createElement("div");e.className="w-100 vh-minus-69-ns";const t=new window.Rapid.Context;t.embed(!0),t.containerNode=e,t.assetPath=d,t.apiConnections=[{url:i.M,client_id:i.I,client_secret:i.J,redirect_uri:i.K}],b({type:r.a.SET_RAPIDEDITOR,context:{context:t,dom:e}})}}),[_,g,E,b]),Object(s.useEffect)((()=>{E&&(E.locale=O)}),[E,O]),Object(s.useEffect)((()=>(p(E),()=>p(E))),[w,E]),Object(s.useEffect)((()=>{const e=f({comment:n,presets:c,gpxUrl:h,powerUser:m,imagery:u});e&&l(e)}),[n,c,h,m,u]),Object(s.useEffect)((()=>{const e=document.getElementById("rapid-container-root"),n=()=>function(e,t){var n;(n=t.changes()).modified.length||n.created.length||n.deleted.length?e(!0):e(!1)}(t,E.systems.edits);if(E&&j){var s;let t;e.appendChild(j),void 0!==(null===E||void 0===E||null===(s=E.systems)||void 0===s?void 0:s.ui)?(p(E),t=Promise.resolve()):t=E.initAsync(),t.then((()=>{const e=E.systems.edits;e.on("change",n),e.on("reset",n)}))}return()=>{var t,s;null!==e&&void 0!==e&&e.childNodes&&j in e.childNodes&&(null===(s=document.getElementById("rapid-container-root"))||void 0===s||s.removeChild(j));if(null!==E&&void 0!==E&&null!==(t=E.systems)&&void 0!==t&&t.edits){const e=E.systems.edits;e.off("change",n),e.off("reset",n)}}}),[j,E,t]),Object(s.useEffect)((()=>{if(E)return()=>E.save()}),[E]),Object(s.useEffect)((()=>{E&&v&&(E.preauth={url:i.M,client_id:i.I,client_secret:i.J,redirect_uri:i.K,access_token:v.osm_oauth_token},E.apiConnections=[E.preauth])}),[E,v,null===v||void 0===v?void 0:v.osm_oauth_token]),Object(a.jsx)("div",{className:"w-100 vh-minus-69-ns",id:"rapid-container-root"})}t.default=h}}]);
//# sourceMappingURL=842.5b6fcff1.chunk.js.map